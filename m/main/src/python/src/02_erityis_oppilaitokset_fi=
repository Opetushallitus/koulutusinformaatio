from operator import itemgetter
from data import s, get, out, dotted_getter

url = "/lo/search/*?&lang=fi&facetFilters=educationType_ffm:et4"
#url = "/lo/search/lukio"

results = get(url)
if "results" in results:
	tempdict = {}
	los = sorted([get(s("/lo/special/{x[id]}")) for x in results["results"]], key=dotted_getter("name"))
	for lo in los:
		id = lo["provider"]["id"]
		if not id in tempdict:
			tempdict[id] = lo["provider"]
			tempdict[id]["los"] = []
			tempdict[id]["los"].append(lo)
		else:
			tempdict[id]["los"].append(lo)
	retval = tempdict.values()
	retval = sorted(retval, key=dotted_getter("name"))
else:
	retval = []
